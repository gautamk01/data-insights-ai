<!DOCTYPE html>
<html>
  <body>
    <input id="q" placeholder="Ask anything…" />
    <button onclick="go()">▶</button>
    <pre id="out"></pre>

    <script>
      async function go() {
        const q = document.getElementById("q").value;
        const out = document.getElementById("out");
        out.innerHTML = "";
        const es = new EventSource(`/ask?question=${encodeURIComponent(q)}`);
        es.onmessage = (e) => {
          const d = JSON.parse(e.data);
          if (d.type === "done") es.close();
          else out.innerHTML += d.text + "\n";
        };
      }
    </script>
  </body>
</html>
